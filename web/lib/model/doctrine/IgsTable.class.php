<?php

/**
 * This class has been auto-generated by the Doctrine ORM Framework
 */
class IgsTable extends DarwinTable
{
  public function fetchByIgNumLimited($ig_num, $limit)
  {
    $conn_MGR = Doctrine_Manager::connection();
    $q = Doctrine_Query::create()
         ->from('Igs i')
         ->where("i.ig_num_indexed like concat (fullToIndex(".$conn_MGR->quote($ig_num, 'string')."), '%') ")
         ->limit($limit)
         ->orderBy("i.ig_num_indexed ASC");
    return $q->execute();
  }

  public function findIgBySpecimenRef($id)
  {
    $spec = Doctrine::getTable('Specimens')->find($id);
    if($spec) {
      $ig = Doctrine::getTable('igs')->find($spec->getIgRef());
      return $ig;
    }
    return null;
  }

  public function findDuplicate($object)
  {
    $q = Doctrine_Query::create()
      ->from('Igs i')
      ->where('i.ig_num = ?', $object->getIgNum());
    return $q->fetchOne(); 
  }
}