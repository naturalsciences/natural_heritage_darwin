<?php
/**
 * This class has been auto-generated by the Doctrine ORM Framework
 */
class CatalogueLevelsTable extends DarwinTable
{
  public function getLevelsByTypes(array $parameters, $q = null)
  {
    if (is_null($q))
    {
      $q = Doctrine_Query::create()
	 ->from('CatalogueLevels cl');
    }
    if (isset($parameters['level']) && $parameters['level'] != '')
    {
      $q->innerJoin('cl.PossibleUpperLevels pul ON cl.id = pul.level_upper_ref')
        ->addWhere('pul.level_ref = ?', $parameters['level']);
    }
    if (isset($parameters['table']))
    {
      $q->addWhere('cl.level_type = ?', $parameters['table']);
    }
    $q->addOrderBy('cl.id') ;
    return $q->execute();
  }
}
