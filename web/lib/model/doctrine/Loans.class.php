<?php

/**
 * Loans
 * 
 * This class has been auto-generated by the Doctrine ORM Framework
 * 
 * @package    darwin
 * @subpackage model
 * @author     DB team <darwin-ict@naturalsciences.be>
 * @version    SVN: $Id: Builder.php 7490 2010-03-29 19:53:27Z jwage $
 */
class Loans extends BaseLoans
{
  public function getFromDateFormatted()
  {
    if(!$this->getFromDate()) return '';
    $dt = new DateTime($this->getFromDate());
    return $dt->format('d/m/Y');
  }

  public function getToDateFormatted()
  {
    if(!$this->getToDate()) return '';
    $dt = new DateTime($this->getToDate());
    return $dt->format('d/m/Y');
  }
  public function getExtendedToDateFormatted()
  {
    if(!$this->getExtendedToDate()) return '';
    $dt = new DateTime($this->getExtendedToDate());
    return $dt->format('d/m/Y');
  }

  public function getIsOverdue()
  {
    if(! $this->getExtendedToDate() && ! $this->getToDate()) return false;

    $dt = new DateTime($this->getExtendedToDate() ? $this->getExtendedToDate() : $this->getToDate());
    $now = new DateTime('now');
    if($dt < $now) return true;
    return false;
  }

  public function fetchHistories()
  {
     return Doctrine::getTable('Loans')->fetchHistories($this->getId());
  }
}
